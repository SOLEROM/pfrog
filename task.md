# promt task

The pfrog tool is a lightweight, bash-based command-line utility for managing build artifacts across multiple embedded boards using a shared NFS directory, with no need for external databases or online services. Each artifact is a directory (such as a compiled U-Boot, kernel, rootfs, Buildroot or Yocto output) that is compressed into a .tar.gz archive using the tar command with options to preserve symbolic links, device files, and all original file permissions. The archive is named using the MD5 checksum of its contents followed by an underscore and an auto-incremented version number (e.g., <md5>_<n>.tar.gz), and is stored under <nfs_root>/<board>/<part>/, where both <board> and <part> are user-defined labels.

When a user runs the push command, the tool resolves the NFS root by first checking the --nfs flag, then the PFROG_ROOT environment variable, then a configuration file (by default ./pfrog.conf, but overridable via --config <file>). It prints the resolved path for confirmation unless the user passes the --yes flag. The tool then compresses the input directory, computes the MD5 checksum, and checks whether that exact file already exists. If it does, it simply reports the existing version; otherwise it uses flock to obtain a .lock file to ensure safe concurrent access, finds the highest version number, increments it, and stores the new file as version n+1. Alongside the artifact, the tool writes an optional metadata file named md5_<n>.meta containing the push timestamp (in ISO-8601 format), the username who performed the push, the exact source-code commit hash, and a user-defined descriptive tag if provided. The tool offers --dry mode to simulate all steps without making actual filesystem changes, --verbose mode for detailed logs, and long-running operations like compression show a progress bar or equivalent visual feedback to improve user experience. A built-in --help flag lists all subcommands and options.

The pull command retrieves a specific version (or the latest, by default) of a given <board>/<part> combination and copies the .tar.gz archive to the current working directory without extracting it. After the download, the tool recalculates the MD5 hash of the file and checks it against the hash in the filename to ensure integrity, issuing a warning on mismatch. If a file of the same name already exists locally, pull will prompt for overwrite unless the user supplies --yes.

The list command prints the existing structure of boards, parts, and artifact versions by scanning the NFS directory tree directly. If .meta files are found next to any version, their contents (timestamp, username, commit hash, tag) are displayed alongside the artifact version, providing richer insight into each build.

Finally, pfrog includes a --generate-completion [bash|zsh|fish] subcommand so users can install shell completion scripts for boards and parts, making the tool even easier to use. The pfrog system relies exclusively on standard UNIX tools and filesystem conventions, never deletes artifacts (relying on directory structure and file naming for versioning and history), and delegates concurrency and access control to simple .lock files and UNIX/NFS permissions. This makes pfrog a fully offline, database-free, bash-native solution tailored for embedded build artifact workflows.